import { Card, CardItem, ConfirmDialog, TopNavBar, USER_TOKEN_KEY, UserTokenStore } from '@presenter/basic'
import { router } from '@kit.ArkUI'

@Entry
@Component
struct Setting {
  confirm: CustomDialogController = new CustomDialogController({
    builder: ConfirmDialog({
      message: 'ç¡®å®šè¦é€€å‡ºç™»å½•å—?',
      buttonList: [{
        text: 'å–æ¶ˆ'
      }, {
        text: 'ç¡®å®š',
        fontColor: $r('app.color.primary'),
        action: () => {
          this.logout()
        }
      }]
    }),
    customStyle: true,
    alignment: DialogAlignment.Center,
    autoCancel: false
  })

  /*-----------------------ðŸ‘‡ðŸ‘‡ function ðŸ‘‡ðŸ‘‡--------------------------------*/
  logout() {
    // åˆ é™¤token
    AppStorage.set<string>(USER_TOKEN_KEY, "")
    new UserTokenStore(getContext(this)).setUserToken("")
    router.replaceUrl({
      url: 'pages/LoginPage/Login'
    })
  }

  build() {
    Column() {
      TopNavBar({ title: 'ä¸ªäººè®¾ç½®' })
      Card() {
        CardItem({ leftTitle: 'æ¢ç»‘æ‰‹æœº', rightText: '' })
        CardItem({ leftTitle: 'ä¿®æ”¹å¯†ç ', rightText: '' })
        CardItem({ leftTitle: 'æ¶ˆæ¯é€šçŸ¥è®¾ç½®', rightText: '' })
        CardItem({ leftTitle: 'æ¸…ç†ç¼“å­˜', rightText: '', showBottomBorder: false })
      }

      Row() {
        Button("é€€å‡º", { type: ButtonType.Normal })
          .backgroundColor($r('app.color.white'))
          .fontColor($r("app.color.text_primary"))
          .width('100%')
          .borderRadius(8)
          .height(60)
          .onClick(() => {
            this.confirm.open()
          })
      }
      .width('100%')
      .margin({
        top: 20
      })
      .padding({
        left: 15,
        right: 15
      })
      .justifyContent(FlexAlign.Center)

    }
    .padding({
      top: JSON.parse(AppStorage.get("topHeight")),
      bottom: JSON.parse(AppStorage.get('bottomHeight'))
    })
    .width('100%')
    .height('100%')
    .backgroundColor($r('app.color.background_page'))
  }
}